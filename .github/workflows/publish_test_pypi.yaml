name: testpypi publish

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]


jobs:
    pypi-publish:
      name: upload release to PyPI
      runs-on: ubuntu-latest
      env:
        PDM_BUILD_SCM_VERSION: 0.0.1
      permissions:
        # This permission is needed for private repositories.
        contents: read
        # IMPORTANT: this permission is mandatory for trusted publishing
        id-token: write
      steps:
        - uses: actions/checkout@v3
  
        - uses: pdm-project/setup-pdm@v3
  
        - name: Publish package distributions to PyPI
          run: | 
            pdm update
            pdm publish --repository testpypi